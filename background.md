## 当前分支与目标
- 当前阶段：UI 细节打磨 + 接口联调 + 编码清理。
- 核心页面：`index`、`venue`、`activity`、`order-pay-success`。
- 交接目的：新会话可直接进入执行阶段，减少上下文重复沟通。

## 已完成状态（按页面）
- `pages/index`：地图 + 卡片样式已多轮迭代；筛选与空态胶囊完成基础调整；卡片按钮样式进入收敛阶段。
- `pages/venue`：已接入商家详情接口；支持商品/动态切换；购买按钮已打通跳转商品详情。
- `pages/activity`：数据源已切到商家接口模型；底部购票区已具备固定展示能力并持续做视觉对齐。
- `pages/order-sub/order-pay-success`：页面结构已在用，下一步对接支付详情接口动态渲染。

## 接口现状（当前应使用）
- `GET /api/v1/merchant/list`：用于首页卡片与活动列表聚合数据。
- `GET /api/v1/merchant/:id`：用于场地详情、活动详情主体数据。
- `GET /api/v1/pay/detail?out_trade_no=...`：用于支付成功页订单详情。
- 网络层统一要求：使用 `@/utils/request`，避免页面内直接散落请求实现。

## 正在处理 / 待处理问题
- 存在历史编码问题：部分文件出现乱码，需统一 UTF-8 清理。
- `src/pages/index/index.tsx` 曾出现大面积语法损坏，已修复；仍需重点防回归。
- 设计稿资源中 `lanhu-oss-proxy.lanhuapp.com` 链接不可用，需持续替换为可访问资源。
- 视觉回归重点：按钮边框、按钮间距、顶部背景铺满、卡片文案对齐。

## 强制工程约束（简化版）
- 所有代码文件必须使用 UTF-8 编码。
- 禁止 `require()` 引入静态资源，统一使用 `import`。
- 禁止直接使用 `Taro.request`（仅保留明确的特殊场景）。
- 禁止引入不可访问素材 URL（尤其是 Lanhu 代理域名）。

## 新会话优先任务（Top 5）
1. 全量清理不可用 Lanhu 资源 URL。
2. 统一修复乱码文案与编码问题。
3. 完成 `order-pay-success` 的 `pay/detail` 接口接入与展示。
4. 整理 `activity/index.tsx` 的类名语义化，降低维护成本。
5. 对 `index` 卡片样式做最终视觉回归并锁定。

## 验证清单
- `eslint` 通过（无 `import/no-commonjs` 报错）。
- `tsc --noEmit` 通过（无语法/类型错误）。
- 微信开发者工具编译通过（无 wxss/tsx 编译错误）。
- 关键页面截图与设计稿主结构一致。

## 风险说明
- 大文件在多次手改后，容易再次引入编码损坏和括号/标签配对错误。
- 设计稿像素级还原与接口动态数据存在天然冲突，优先保证可读性、可维护性与数据正确性。
- 视觉问题应以可复现截图为准逐项回归，避免“修复 A 破坏 B”。
